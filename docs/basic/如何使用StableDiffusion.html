<!doctype html>
<html lang="en" dir="ltr" class="docs-wrapper docs-doc-page docs-version-current plugin-docs plugin-id-default docs-doc-id-basic/如何使用StableDiffusion">
<head>
<meta charset="UTF-8">
<meta name="generator" content="Docusaurus v2.4.0">
<title data-rh="true">如何使用StableDiffusion | Stable Diffusion Model Tutorial</title><meta data-rh="true" name="viewport" content="width=device-width,initial-scale=1"><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:image" content="https://stable-diffusion.dongwm.com/img/docusaurus-social-card.jpg"><meta data-rh="true" name="twitter:image" content="https://stable-diffusion.dongwm.com/img/docusaurus-social-card.jpg"><meta data-rh="true" property="og:url" content="https://stable-diffusion.dongwm.com/docs/basic/如何使用StableDiffusion"><meta data-rh="true" name="docusaurus_locale" content="en"><meta data-rh="true" name="docsearch:language" content="en"><meta data-rh="true" name="docusaurus_version" content="current"><meta data-rh="true" name="docusaurus_tag" content="docs-default-current"><meta data-rh="true" name="docsearch:version" content="current"><meta data-rh="true" name="docsearch:docusaurus_tag" content="docs-default-current"><meta data-rh="true" property="og:title" content="如何使用StableDiffusion | Stable Diffusion Model Tutorial"><meta data-rh="true" name="description" content="前言"><meta data-rh="true" property="og:description" content="前言"><link data-rh="true" rel="icon" href="/img/favicon.ico"><link data-rh="true" rel="canonical" href="https://stable-diffusion.dongwm.com/docs/basic/如何使用StableDiffusion"><link data-rh="true" rel="alternate" href="https://stable-diffusion.dongwm.com/docs/basic/如何使用StableDiffusion" hreflang="en"><link data-rh="true" rel="alternate" href="https://stable-diffusion.dongwm.com/docs/basic/如何使用StableDiffusion" hreflang="x-default"><link rel="stylesheet" href="/assets/css/styles.a21331cf.css">
<link rel="preload" href="/assets/js/runtime~main.4b3b1165.js" as="script">
<link rel="preload" href="/assets/js/main.fce4b4d2.js" as="script">
</head>
<body class="navigation-with-keyboard">
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){var t=null;try{t=new URLSearchParams(window.location.search).get("docusaurus-theme")}catch(t){}return t}()||function(){var t=null;try{t=localStorage.getItem("theme")}catch(t){}return t}();t(null!==e?e:"light")}()</script><div id="__docusaurus">
<div role="region" aria-label="Skip to main content"><a class="skipToContent_fXgn" href="#docusaurus_skipToContent_fallback">Skip to main content</a></div><nav aria-label="Main" class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Toggle navigation bar" aria-expanded="false" class="navbar__toggle clean-btn" type="button"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/"><div class="navbar__logo"><img src="/img/logo.svg" alt="Logo" class="themedImage_ToTc themedImage--light_HNdA"><img src="/img/logo.svg" alt="Logo" class="themedImage_ToTc themedImage--dark_i4oU"></div><b class="navbar__title text--truncate">Stable Diffusion Model Tutorial</b></a><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/docs/category/basic">入门教程</a><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/docs/category/basic">高级教程</a><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/docs/category/basic">实践</a></div><div class="navbar__items navbar__items--right"><a href="https://github.com/facebook/docusaurus" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a><div class="toggle_vylO colorModeToggle_DEke"><button class="clean-btn toggleButton_gllP toggleButtonDisabled_aARS" type="button" disabled="" title="Switch between dark and light mode (currently light mode)" aria-label="Switch between dark and light mode (currently light mode)" aria-live="polite"><svg viewBox="0 0 24 24" width="24" height="24" class="lightToggleIcon_pyhR"><path fill="currentColor" d="M12,9c1.65,0,3,1.35,3,3s-1.35,3-3,3s-3-1.35-3-3S10.35,9,12,9 M12,7c-2.76,0-5,2.24-5,5s2.24,5,5,5s5-2.24,5-5 S14.76,7,12,7L12,7z M2,13l2,0c0.55,0,1-0.45,1-1s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S1.45,13,2,13z M20,13l2,0c0.55,0,1-0.45,1-1 s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S19.45,13,20,13z M11,2v2c0,0.55,0.45,1,1,1s1-0.45,1-1V2c0-0.55-0.45-1-1-1S11,1.45,11,2z M11,20v2c0,0.55,0.45,1,1,1s1-0.45,1-1v-2c0-0.55-0.45-1-1-1C11.45,19,11,19.45,11,20z M5.99,4.58c-0.39-0.39-1.03-0.39-1.41,0 c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0s0.39-1.03,0-1.41L5.99,4.58z M18.36,16.95 c-0.39-0.39-1.03-0.39-1.41,0c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0c0.39-0.39,0.39-1.03,0-1.41 L18.36,16.95z M19.42,5.99c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06c-0.39,0.39-0.39,1.03,0,1.41 s1.03,0.39,1.41,0L19.42,5.99z M7.05,18.36c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06 c-0.39,0.39-0.39,1.03,0,1.41s1.03,0.39,1.41,0L7.05,18.36z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" class="darkToggleIcon_wfgR"><path fill="currentColor" d="M9.37,5.51C9.19,6.15,9.1,6.82,9.1,7.5c0,4.08,3.32,7.4,7.4,7.4c0.68,0,1.35-0.09,1.99-0.27C17.45,17.19,14.93,19,12,19 c-3.86,0-7-3.14-7-7C5,9.07,6.81,6.55,9.37,5.51z M12,3c-4.97,0-9,4.03-9,9s4.03,9,9,9s9-4.03,9-9c0-0.46-0.04-0.92-0.1-1.36 c-0.98,1.37-2.58,2.26-4.4,2.26c-2.98,0-5.4-2.42-5.4-5.4c0-1.81,0.89-3.42,2.26-4.4C12.92,3.04,12.46,3,12,3L12,3z"></path></svg></button></div><div class="searchBox_ZlJk"></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div id="docusaurus_skipToContent_fallback" class="main-wrapper mainWrapper_z2l0 docsWrapper_BCFX"><button aria-label="Scroll back to top" class="clean-btn theme-back-to-top-button backToTopButton_sjWU" type="button"></button><div class="docPage__5DB"><aside class="theme-doc-sidebar-container docSidebarContainer_b6E3"><div class="sidebarViewport_Xe31"><div class="sidebar_njMd"><nav aria-label="Docs sidebar" class="menu thin-scrollbar menu_SIkG"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--active" href="/docs/category/basic">Basic</a></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/basic/AIGC发展史">AIGC发展史</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" tabindex="0" href="/docs/basic/如何使用StableDiffusion">如何使用StableDiffusion</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/basic/TextualInversion-Embedding">TextualInversion-Embedding</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/basic/Extension">Extension</a></li></ul></li></ul></nav></div></div></aside><main class="docMainContainer_gTbr"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_VOVn"><div class="docItemContainer_Djhp"><article><nav class="theme-doc-breadcrumbs breadcrumbsContainer_Z_bl" aria-label="Breadcrumbs"><ul class="breadcrumbs" itemscope="" itemtype="https://schema.org/BreadcrumbList"><li class="breadcrumbs__item"><a aria-label="Home page" class="breadcrumbs__link" href="/"><svg viewBox="0 0 24 24" class="breadcrumbHomeIcon_YNFT"><path d="M10 19v-5h4v5c0 .55.45 1 1 1h3c.55 0 1-.45 1-1v-7h1.7c.46 0 .68-.57.33-.87L12.67 3.6c-.38-.34-.96-.34-1.34 0l-8.36 7.53c-.34.3-.13.87.33.87H5v7c0 .55.45 1 1 1h3c.55 0 1-.45 1-1z" fill="currentColor"></path></svg></a></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item"><a class="breadcrumbs__link" itemprop="item" href="/docs/category/basic"><span itemprop="name">Basic</span></a><meta itemprop="position" content="1"></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item breadcrumbs__item--active"><span class="breadcrumbs__link" itemprop="name">如何使用StableDiffusion</span><meta itemprop="position" content="2"></li></ul></nav><div class="tocCollapsible_ETCw theme-doc-toc-mobile tocMobile_ITEo"><button type="button" class="clean-btn tocCollapsibleButton_TO0P">On this page</button></div><div class="theme-doc-markdown markdown"><header><h1>如何使用StableDiffusion</h1></header><h3 class="anchor anchorWithStickyNavbar_LWe7" id="前言">前言<a href="#前言" class="hash-link" aria-label="Direct link to 前言" title="Direct link to 前言">​</a></h3><p>今天这篇介绍怎么运行SD，包含在线使用和本地运行stable-diffusion-webui，并体验效果。</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="civitai平台">Civitai平台<a href="#civitai平台" class="hash-link" aria-label="Direct link to Civitai平台" title="Direct link to Civitai平台">​</a></h3><p>首先要介绍一个平台：<a href="https://civitai.com/" target="_blank" rel="noopener noreferrer">Civitai</a>是目前最知名的Stable Diffusion AI 艺术模型的社区平台，用户把它称为C站，它里面有非常多用户上传的模型:</p><p><img loading="lazy" src="https://user-images.githubusercontent.com/841395/233838320-d2c443d6-9c3c-421f-a287-787b4f1f75e8.png" class="img_ev3q"></p><p>另外可以通过图片过滤，且模型里面会列出相关用户上传的优质图片。图片页面有相关的提示词文本、使用的模型以及采样数据等参数，可以帮助还不熟悉Stable Diffusion的用户快速上手:</p><p><img loading="lazy" src="https://user-images.githubusercontent.com/841395/233838377-f3d5a0da-a5c8-4940-aaef-4dba29435332.png" class="img_ev3q"></p><p>PS: <code>Browing mode</code>选择<code>Everything</code>有惊喜，请做好心理建设哟~</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="在线使用stable-diffusion">在线使用Stable Diffusion<a href="#在线使用stable-diffusion" class="hash-link" aria-label="Direct link to 在线使用Stable Diffusion" title="Direct link to 在线使用Stable Diffusion">​</a></h3><p>如果你只是想要试玩一下，最简单的方法就是在线访问Stable Diffusion官方网站 <a href="https://beta.dreamstudio.ai/" target="_blank" rel="noopener noreferrer">https://beta.dreamstudio.ai/</a> ，可以免费产生约一百张图，之后需付少许费用。</p><p><img loading="lazy" src="https://user-images.githubusercontent.com/841395/233838971-cc84eb22-ed17-46bc-9c0d-30267ec280d8.png" class="img_ev3q"></p><p>其实还有一些其他在线服务，但都是阉割版(例如不支持模型选择，不支持插件等等），无法体现Stable Diffusion的真实能力，就不推荐了，大家认准官方就好了。</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="本地部署stable-diffusion">本地部署Stable Diffusion<a href="#本地部署stable-diffusion" class="hash-link" aria-label="Direct link to 本地部署Stable Diffusion" title="Direct link to 本地部署Stable Diffusion">​</a></h3><p>这个我主推的方式，也是玩Stable Diffusion最有意思的地方。目前最主流的方法就是使用<a href="https://github.com/AUTOMATIC1111/stable-diffusion-webui" target="_blank" rel="noopener noreferrer">https://github.com/AUTOMATIC1111/stable-diffusion-webui</a>这个项目，本地运行一个Python的Web UI。</p><p>首先要明确AI绘画需要进行大量的图像处理和计算，所以对于电脑是有硬件要求的:</p><blockquote><p>本地运行需要需要足够大的显存(独立显卡的内存)，最低配置10GB显存，越大越好。 内存也不能太小，最好大于16GB。显存大小决定了你能生成的图片尺寸，一般而言图片尺寸越大，SD能发挥的地方越多，画面里填充的细节就越多。
通常都是用通过GPU来跑SD，因为GPU会加速计算。但用CPU跑也是可以的，但是速度会非常慢: 例如一张显卡30秒就能算好的图，CPU要算10分钟。</p></blockquote><p>我的电脑是Macbook M1架构，所以参照的官方wiki文档<a href="https://github.com/AUTOMATIC1111/stable-diffusion-webui/wiki/Installation-on-Apple-Silicon" target="_blank" rel="noopener noreferrer">Installation on Apple Silicon</a>配置即可，简单看了下启动脚本，即便不是Python开发者我认为也可以顺滑的完成启动过程。接下来是我配置的过程:</p><p>首先下载相关依赖和stable-diffusion-webui:</p><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">➜ brew </span><span class="token function" style="color:#d73a49">install</span><span class="token plain"> cmake protobuf rust python@3.10 </span><span class="token function" style="color:#d73a49">git</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">wget</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">➜ </span><span class="token builtin class-name">cd</span><span class="token plain"> ~/workspace</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">➜ </span><span class="token function" style="color:#d73a49">git</span><span class="token plain"> clone https://github.com/AUTOMATIC1111/stable-diffusion-webui</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>目前只是代码克隆下来，还没有任何可用模型，此时可以从文档提到的<a href="https://huggingface.co/models?pipeline_tag=text-to-image&amp;sort=downloads" target="_blank" rel="noopener noreferrer">Hugging Face</a>或者<a href="https://www.Civitai.com" target="_blank" rel="noopener noreferrer">C站Civitai.com</a>下载模型。</p><p>模型格式一般是.ckpt或者.safetensors 作为文件扩展名。格式的区别是:</p><p><code>.ckpt</code>: 包含Python 代码的压缩文件，对于Python语言的程序来说很通用方便，缺点是文件很大，一般2-8G。
<code>.safetensors</code>: 只包含生成所需的数据，不包含代码，一般只有几十到几百M，加载文件也更安全和快速。</p><p>我一般从C站下载，找了一个例子:  <a href="https://civitai.com/models/25995/blindbox" target="_blank" rel="noopener noreferrer">https://civitai.com/models/25995/blindbox</a></p><p><img loading="lazy" src="https://user-images.githubusercontent.com/841395/233839700-642374fd-0bba-4e6d-aa55-59ea6c9e90ff.png" class="img_ev3q"></p><p>注意，这是一个Lora模型(右侧信息中的Type是LORA)，所以和文档说的放在<code>models/Stable-diffusion</code>目录不同，应该放在<code>models/Lora</code>。</p><div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token function" style="color:#d73a49">mv</span><span class="token plain"> ~/Downloads/blindbox_V1Mix.safetensors ~/workspace/stable-diffusion-webui/models/Lora</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>然后拉到页面下面，我找到了一个生成的效果图 <a href="https://civitai.com/images/421118?period=AllTime&amp;sort=Most+Reactions&amp;modelVersionId=32988&amp;modelId=25995&amp;postId=128086" target="_blank" rel="noopener noreferrer">https://civitai.com/images/421118?period=AllTime&amp;sort=Most+Reactions&amp;modelVersionId=32988&amp;modelId=25995&amp;postId=128086</a></p><p><img loading="lazy" src="https://user-images.githubusercontent.com/841395/234440024-c45d5b70-c73c-4e1f-9dc6-038c837cda99.png" class="img_ev3q"></p><p>可以看到生成这个图时候用的各个参数，注意其中的Model叫做`revAnimated_v11·，本地也没有需要下载，可以先搜一下就找到了: <a href="https://civitai.com/models/7371/rev-animated" target="_blank" rel="noopener noreferrer">https://civitai.com/models/7371/rev-animated</a></p><p><img loading="lazy" src="https://user-images.githubusercontent.com/841395/233839915-af9b52e3-13a0-412c-a9ff-bcb28516bdf5.png" class="img_ev3q"></p><p>可以看到右侧的Type说明它是一个CHECKPOINT的类型，下载并把它放在<code>models/Stable-diffusion</code>目录:</p><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token function" style="color:#d73a49">mv</span><span class="token plain"> ~/Downloads/revAnimated_v122.safetensors ~/workspace/stable-diffusion-webui/models/Stable-diffusion</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>这里提一下<code>Checkpoint</code>这个模型类型，按我的理解它表示<strong>存档点</strong>，就是可以使用开源的Stable-diffusion不同版本的某个点作为模型使用。另外这个模型子类型叫做<code>Checkpoint Merge</code>，也就是它是将多个模型混合在一起，而且合并后不同的模型占了不一样的比例的权重。</p><p>然后启动webUI:</p><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token builtin class-name">cd</span><span class="token plain"> stable-diffusion-webui</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">./webui.sh</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>第一次启动会下载相关依赖，比较慢，下载完成就会看到启动提示:</p><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token punctuation" style="color:#393A34">..</span><span class="token plain">.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Running on </span><span class="token builtin class-name">local</span><span class="token plain"> URL:  http://127.0.0.1:7860</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>打开浏览器，访问这个地址就可以看到Web页面了。SD目前支持文生图和图生图2个模式，这篇文章先体验文生图，图生图因为需要很多额外的知识我们过段时间铺垫完了再专门写。</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="文本转图片txt2img">文本转图片(txt2img)<a href="#文本转图片txt2img" class="hash-link" aria-label="Direct link to 文本转图片(txt2img)" title="Direct link to 文本转图片(txt2img)">​</a></h3><p>这是SD最基础的功能，将文本提示转换为图像。还是用上面提到的blindbox的例子，就用它的各种参数，唯一要提的是「Batch size」选了8，，就是一次性生成8张图(事实是9张，另外一张是全部图的缩略图)，然后点右侧的「Generate」，就会开始生成了，大概10来分钟(如果单张图约1分钟):</p><p><img loading="lazy" src="https://user-images.githubusercontent.com/841395/234441778-eb2ecb12-425f-4b7a-8d6f-37e2a0032d9c.png" class="img_ev3q"></p><p>生成的效果非常好。先介绍下各个参数项和用途:</p><ol><li>左侧最上面「Stable Diffusion checkpoint」是个下拉框，可以选择您想要的模型。有很多已经训练好的模型可供选择，如果你有自己特别的需求，也可以训练自己的模型。</li><li>左侧有2个文本输入框，上面宽的那个输入正向提示词(prompt)文本，表示你希望这个图符合什么要求，下面窄的输入反向提示词(Negative Prompt)文本，表示这个图不希望符合什么要求。提示词可以是英文短句或单词，以逗号进行分隔，它们类似标签(tag)列表。</li><li>Sampling Method用于去噪，平衡生成图的速度和质量。内置多种算法可供选择。目前看起来DPM++ 2M Karras用的比较多。</li><li>Sampling Steps是去噪过程的采样步骤数。越多越好，但需要更长的时间。一般在20-28之间。</li><li>宽度和高度(Width/Height)，输出图像的大小。按需调整即可。</li><li>Batch Count 批次数量，我更愿意用下面的Batch size调整生产图的总数。</li><li>Batch size，每一批次要生成的图像数量。可以在测试提示时多生成一些，因为每个生成的图像都会有所不同。生成的图像总数等于Batch Count乘以Batch size。</li><li>CFG(Classifier Free Guidance) scale，提示词相关性， 用于控制模型应在多大程度上遵从您的提示。他有几个只可选: 1(大多忽略你的提示)，3(更有创意)，7(遵循提示和自由之间的良好平衡)，15(更加遵守提示)，30(严格按照提示操作)，常用的是7，做个平衡。测试时可以换这个值体验区别。</li><li>Seed，生成的每个图像都有自己的种子值，修改这个值可以控制图像的内容。</li><li>Script。用户可以编写脚本代码，以实现一些特殊定制的功能。这个未来可以具体说，目前还没有遇到。</li></ol><p>在生成的过程中会感受到图片从模糊到清晰的过程。如果你特别细心，可以看到正向prompt里面比原图多了一个<code>&lt;lora:blindbox_V1Mix:1&gt;</code>，这个其实是指定了Lora模型后添加的，选择Lora模型的方法是点开「Genrate」按钮下面中间那个按钮「show/hide extra network」，最右一个Tab就是Lora:</p><p><img loading="lazy" src="https://user-images.githubusercontent.com/841395/234441787-e4dc94f7-8151-46cf-8a5e-0c055224e72c.png" class="img_ev3q"></p><p>选择你要用的模型就会在prompt输入框里面添加或者删除Lora模型。</p><p>可以看到，参数都一样的前提下，不同机器的相同seed出图是不一样的，但是在本机设置了同一个seed，重复生成图是一样的(注:把seed输入框改成默认的-1就是随机的):</p><p>PS: 一个好习惯是点击下面的Save，会把图片按照日期存在本地。</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="如何写好提示词">如何写好提示词<a href="#如何写好提示词" class="hash-link" aria-label="Direct link to 如何写好提示词" title="Direct link to 如何写好提示词">​</a></h3><p>我也正在学习写好用好提示词，目前有2个技巧。</p><h4 class="anchor anchorWithStickyNavbar_LWe7" id="寻找好的范例">寻找好的范例<a href="#寻找好的范例" class="hash-link" aria-label="Direct link to 寻找好的范例" title="Direct link to 寻找好的范例">​</a></h4><p>提示词主要包含标签和艺术家，可以从如下几个有用的网站获取更多信息:</p><ol><li><a href="https://rentry.org/artists_sd-v1-4" target="_blank" rel="noopener noreferrer">https://rentry.org/artists_sd-v1-4</a> 艺术家列表</li><li><a href="https://www.urania.ai/top-sd-artists" target="_blank" rel="noopener noreferrer">https://www.urania.ai/top-sd-artists</a> 艺术家列表</li><li><a href="https://stablediffusion.fr/artists" target="_blank" rel="noopener noreferrer">https://stablediffusion.fr/artists</a> 艺术家列表</li><li><a href="https://ai.dawnmark.cn/" target="_blank" rel="noopener noreferrer">https://ai.dawnmark.cn/</a>  图像细节，如风格、光照等</li><li><a href="https://tinygeeker.github.io/p/ai-prompt-generator/" target="_blank" rel="noopener noreferrer">https://tinygeeker.github.io/p/ai-prompt-generator/</a> AI 标签生成器，身体细节</li><li><a href="https://github.com/wfjsw/danbooru-diffusion-prompt-builder" target="_blank" rel="noopener noreferrer">https://github.com/wfjsw/danbooru-diffusion-prompt-builder</a> Danbooru 标签超市</li></ol><p>当然这种网站很多，欢迎浏览补充</p><h4 class="anchor anchorWithStickyNavbar_LWe7" id="获取ai生成图的提示词以及其它参数">获取AI生成图的提示词以及其它参数<a href="#获取ai生成图的提示词以及其它参数" class="hash-link" aria-label="Direct link to 获取AI生成图的提示词以及其它参数" title="Direct link to 获取AI生成图的提示词以及其它参数">​</a></h4><p>用SD生成的图的元数据中包含了生产时用的提示词以及各个参数等信息，在<code>stable-diffusion-webui</code>里面有个页面叫做「PNG info」，非常实用，只需要上传图片就可以看到这些原始信息:</p><p><img loading="lazy" src="https://user-images.githubusercontent.com/841395/235357216-5a56c2b4-0b5f-4fb6-b964-80e01bf325b0.png" class="img_ev3q"></p><p>BTW，现在各平台限制AI图也是基于这个源数据识别，所以再处理掉图片文件中的这些信息就可以了。</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="在colab上运行stable-diffusion-webui">在Colab上运行stable-diffusion-webui<a href="#在colab上运行stable-diffusion-webui" class="hash-link" aria-label="Direct link to 在Colab上运行stable-diffusion-webui" title="Direct link to 在Colab上运行stable-diffusion-webui">​</a></h3><p>本来可以使用Google Colab免费运行stable-diffusion-webui，但是已经不再容许免费用户这么用了，4月21日，Colab的产品lead发推提到了这件事，所以如果你看到有些教程提到使用Colab要注意得是付费用户了。不过我本来也不想推荐这个方式，主要是免费用户的空间是25G，如果你下载主模型等等相关资源是很容易超的，所以开始主推本地运行。</p><p>Colab付费用户可以看这个项目: <a href="https://github.com/camenduru/stable-diffusion-webui-colab" target="_blank" rel="noopener noreferrer">https://github.com/camenduru/stable-diffusion-webui-colab</a></p></div><footer class="theme-doc-footer docusaurus-mt-lg"><div class="theme-doc-footer-edit-meta-row row"><div class="col"><a href="https://github.com/facebook/docusaurus/tree/main/packages/create-docusaurus/templates/shared/docs/basic/如何使用StableDiffusion.md" target="_blank" rel="noreferrer noopener" class="theme-edit-this-page"><svg fill="currentColor" height="20" width="20" viewBox="0 0 40 40" class="iconEdit_Z9Sw" aria-hidden="true"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>Edit this page</a></div><div class="col lastUpdated_vwxv"></div></div></footer></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Docs pages navigation"><a class="pagination-nav__link pagination-nav__link--prev" href="/docs/basic/AIGC发展史"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">AIGC发展史</div></a><a class="pagination-nav__link pagination-nav__link--next" href="/docs/basic/TextualInversion-Embedding"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">TextualInversion-Embedding</div></a></nav></div></div><div class="col col--3"><div class="tableOfContents_bqdL thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#前言" class="table-of-contents__link toc-highlight">前言</a></li><li><a href="#civitai平台" class="table-of-contents__link toc-highlight">Civitai平台</a></li><li><a href="#在线使用stable-diffusion" class="table-of-contents__link toc-highlight">在线使用Stable Diffusion</a></li><li><a href="#本地部署stable-diffusion" class="table-of-contents__link toc-highlight">本地部署Stable Diffusion</a></li><li><a href="#文本转图片txt2img" class="table-of-contents__link toc-highlight">文本转图片(txt2img)</a></li><li><a href="#如何写好提示词" class="table-of-contents__link toc-highlight">如何写好提示词</a></li><li><a href="#在colab上运行stable-diffusion-webui" class="table-of-contents__link toc-highlight">在Colab上运行stable-diffusion-webui</a></li></ul></div></div></div></div></main></div></div><footer class="footer footer--dark"><div class="container container-fluid"><div class="footer__bottom text--center"><div class="footer__copyright">Copyright © 2023 Stable diffusion 中文指南, Inc.</div></div></div></footer></div>
<script src="/assets/js/runtime~main.4b3b1165.js"></script>
<script src="/assets/js/main.fce4b4d2.js"></script>
</body>
</html>